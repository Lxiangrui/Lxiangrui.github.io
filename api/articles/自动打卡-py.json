{"title":"自动打卡.py","uid":"cea6e522f75ce7dc72f7d48196283264","slug":"自动打卡-py","date":"2022-02-08T18:04:50.000Z","updated":"2022-04-09T09:59:17.857Z","comments":true,"path":"api/articles/自动打卡-py.json","keywords":null,"cover":"https://s1.ax1x.com/2022/04/09/Lil3jA.png","content":"<h2 id=\"屁话：\"><a href=\"#屁话：\" class=\"headerlink\" title=\"屁话：\"></a>屁话：</h2><p>这是一个超级简单的脚本，是我第一次用python实现的一个小功能吧。</p>\n<p>一开始的目标就是做一个能自动打卡的脚本，但是在做的过程中，发现如果要做到很好，还是很困难的。</p>\n<p>现在脚本的功能就是：每天自动在7：00打卡（通过bat执行）</p>\n<p>采样python的webdriver来控制浏览器打开网页，用pyautogui来控制鼠标键盘</p>\n<h2 id=\"还是有很多可以完善的地方的：\"><a href=\"#还是有很多可以完善的地方的：\" class=\"headerlink\" title=\"还是有很多可以完善的地方的：\"></a>还是有很多可以完善的地方的：</h2><p>1、比如因为我在使用webdriver时，不能寻找到新的页面的元素，这导致我用了pyautogui来操纵鼠标控制，而使用这种方式后就以为着不能直接在其他电脑上执行，当然，解决办法，还是有的，pyautogui也是有查找元素的功能的，但是它是通过图片的方式，相较于webdriver，它只能查找显示到屏幕的内容，但也是一种选择。</p>\n<p>2、我们学校的打卡网页，必须在移动端打开才能打卡，所以使用webdriver的时候需要先把它模拟为移动端的浏览器，也是通过pyautogui控制键盘打开，就很拉。</p>\n<p>3、在打卡的时候，需要获取实时地址，实际测试下，chrom获取的位置根本不行，后来发现edge还行，这也导致了我不能将它部署在服务器上，需要一种将我的电脑打开，就很蠢。如果可以了解更深里面的，比如网页时如何获取实时地址的话，那应该可以解决，但是对于现在的我，这样就行了。</p>\n<h2 id=\"MORE\"><a href=\"#MORE\" class=\"headerlink\" title=\"MORE:\"></a>MORE:</h2><p>我听说我的一个学长，他直接也做了一个自动打卡的，他是全栈加硬件，我可以去问一些他是怎么实现的哈。我能想到的就是，大家经常说的抓包啥的了。</p>\n<h2 id=\"程序源码：\"><a href=\"#程序源码：\" class=\"headerlink\" title=\"程序源码：\"></a>程序源码：</h2><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> ast <span class=\"token keyword\">import</span> Pass\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>by <span class=\"token keyword\">import</span> By\n<span class=\"token comment\">#from selenium.webdriver import edge</span>\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token comment\">#from selenium.webdriver.edge.options import Options</span>\n<span class=\"token keyword\">import</span> pyautogui\n<span class=\"token keyword\">import</span> time\n \nwidth<span class=\"token punctuation\">,</span>height <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">,</span>height<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 1920 1080</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pyautogui<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 得到当前鼠标位置；输出：Point(x=200, y=800)</span>\n\n<span class=\"token comment\"># pyautogui.moveTo(179,503,duration=1)   # 第一个参数是左右移动像素值，第二个是上下，</span>\n\n\n \nwd <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Edge<span class=\"token punctuation\">(</span><span class=\"token string\">r'd:\\MicroftWebDriver.exe'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># wd =   webdriver.Chrome(r'd:\\chromedriver.exe')</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n\nwd<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://wb.scujj.edu.cn/relax/mobile/index.html#/common/office/login'</span><span class=\"token punctuation\">)</span>\n \ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">208</span><span class=\"token punctuation\">,</span><span class=\"token number\">520</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  \n\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#快捷键设置 模拟手机请求</span>\npyautogui<span class=\"token punctuation\">.</span>press<span class=\"token punctuation\">(</span><span class=\"token string\">'f12'</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>press<span class=\"token punctuation\">(</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>press<span class=\"token punctuation\">(</span><span class=\"token string\">'enter'</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>keyDown<span class=\"token punctuation\">(</span><span class=\"token string\">'ctrl'</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>keyDown<span class=\"token punctuation\">(</span><span class=\"token string\">'shift'</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>press<span class=\"token punctuation\">(</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>keyUp<span class=\"token punctuation\">(</span><span class=\"token string\">'ctrl'</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>keyUp<span class=\"token punctuation\">(</span><span class=\"token string\">'shift'</span><span class=\"token punctuation\">)</span>\n\n\n\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nusar_num <span class=\"token operator\">=</span> wd<span class=\"token punctuation\">.</span>find_elements<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>CLASS_NAME<span class=\"token punctuation\">,</span> <span class=\"token string\">\"weui-input\"</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">#输入账号和密码</span>\nusar_num<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"1906100147\"</span><span class=\"token punctuation\">)</span>          \nusar_num<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"1906100147\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># wd.find_element(By.CLASS_NAME,'weui_btn_primary').click()</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">208</span><span class=\"token punctuation\">,</span><span class=\"token number\">520</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  \n\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">179</span><span class=\"token punctuation\">,</span><span class=\"token number\">503</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  \ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\n\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">318</span><span class=\"token punctuation\">,</span><span class=\"token number\">597</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 健康</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">214</span><span class=\"token punctuation\">,</span><span class=\"token number\">602</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span> \ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">,</span><span class=\"token number\">642</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 是否发热</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">202</span><span class=\"token punctuation\">,</span><span class=\"token number\">656</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  \ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">196</span><span class=\"token punctuation\">,</span><span class=\"token number\">699</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 其他症状</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">196</span><span class=\"token punctuation\">,</span><span class=\"token number\">418</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  \ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">337</span><span class=\"token punctuation\">,</span><span class=\"token number\">319</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span> \ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">242</span><span class=\"token punctuation\">,</span><span class=\"token number\">900</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 地区风险等级</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">210</span><span class=\"token punctuation\">,</span><span class=\"token number\">704</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span> \ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span><span class=\"token number\">984</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">#   提交</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"打卡完成！！！当前鼠标位置:\"</span><span class=\"token punctuation\">,</span>pyautogui<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 得到当前鼠标位置；输出：Point(x=200, y=800)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n","feature":true,"text":"屁话：这是一个超级简单的脚本，是我第一次用python实现的一个小功能吧。 一开始的目标就是做一个能自动打卡的脚本，但是在做的过程中，发现如果要做到很好，还是很困难的。 现在脚本的功能就是：每天自动在7：00打卡（通过bat执行） 采样python的webdriver来控制浏览器...","link":"","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[{"name":"图一乐","slug":"图一乐","count":1,"path":"api/categories/图一乐.json"}],"tags":[{"name":"python","slug":"python","count":1,"path":"api/tags/python.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%B1%81%E8%AF%9D%EF%BC%9A\"><span class=\"toc-text\">屁话：</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%98%E6%98%AF%E6%9C%89%E5%BE%88%E5%A4%9A%E5%8F%AF%E4%BB%A5%E5%AE%8C%E5%96%84%E7%9A%84%E5%9C%B0%E6%96%B9%E7%9A%84%EF%BC%9A\"><span class=\"toc-text\">还是有很多可以完善的地方的：</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#MORE\"><span class=\"toc-text\">MORE:</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%A8%8B%E5%BA%8F%E6%BA%90%E7%A0%81%EF%BC%9A\"><span class=\"toc-text\">程序源码：</span></a></li></ol>","author":{"name":"祥瑞","slug":"blog-author","avatar":"https://s1.ax1x.com/2022/04/08/L9tIA0.jpg","link":"/","description":"励志成为野生钢铁侠-稚晖君的小弟 <br /> @ <b>B站：电工渣</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"pid学习","uid":"a22b5a6b2aea63003d83f444c152a314","slug":"pid学习","date":"2022-04-12T15:46:49.000Z","updated":"2022-04-24T10:55:12.498Z","comments":true,"path":"api/articles/pid学习.json","keywords":null,"cover":"https://s1.ax1x.com/2022/04/15/L8VPln.jpg","text":"pid学习PID 实指“比例 proportional”、“积分 integral”、“微分 derivative” 理解位置式pid和增量式pid：为什么有位置式pid和增量式pid？数字 PID 控制算法因时间离散化不同，通常分为位置式 PID 控制算法和增量式 PID 控制...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"控制原理","slug":"控制原理","count":1,"path":"api/categories/控制原理.json"}],"tags":[{"name":"知识学习","slug":"知识学习","count":1,"path":"api/tags/知识学习.json"}],"author":{"name":"祥瑞","slug":"blog-author","avatar":"https://s1.ax1x.com/2022/04/08/L9tIA0.jpg","link":"/","description":"励志成为野生钢铁侠-稚晖君的小弟 <br /> @ <b>B站：电工渣</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"X-bot","uid":"e81953d080c3cdbe02749919d9ab3a38","slug":"X-bot","date":"2021-10-23T13:41:29.000Z","updated":"2022-04-09T10:00:44.288Z","comments":true,"path":"api/articles/X-bot.json","keywords":null,"cover":"https://z3.ax1x.com/2021/10/24/5W19Cn.jpg","text":"X-bot前言这个项目是我在稚辉君的视频里面看见的，是一个完全开源的项目，而且对他来说是一个比较简单的项目，但对于我这种没有什么DIY经验的同学来说，还是有点难的，不过可能我运气比较好吧，在他的视频评论区下面找到了一个大佬，他帮助了我很多,最后好像玩着玩着断断续续一直弄了1个多月...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"DIY","slug":"DIY","count":1,"path":"api/categories/DIY.json"}],"tags":[{"name":"写字机器人","slug":"写字机器人","count":1,"path":"api/tags/写字机器人.json"}],"author":{"name":"祥瑞","slug":"blog-author","avatar":"https://s1.ax1x.com/2022/04/08/L9tIA0.jpg","link":"/","description":"励志成为野生钢铁侠-稚晖君的小弟 <br /> @ <b>B站：电工渣</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}